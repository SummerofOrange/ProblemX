# 更新日志

## v2.1 (2026-01-27)

  - **辅助答题系统 (PTA Assistant) 全新上线**：
    - **智能自动答题**：支持一键“自动答题”，根据设定阈值自动从本地题库搜索最佳匹配答案并填入网页，大幅提升练习效率。
    - **实时状态反馈**：左侧题目列表通过颜色直观展示状态（绿色-已作答，红色-新题/无匹配，黄色-未作答，蓝色-选中）。
    - **双向交互优化**：点击题目列表自动定位网页位置；支持手动“填入答案”功能；右侧实时展示本地题库搜索结果与预览。
    - **新题导出**：支持将未匹配到的新题目一键导出为 JSON 题库，便于扩充题库。
    - **操作日志**：新增日志面板，实时记录解析、搜索、填入等操作详情。

  - **界面与体验升级**：
    - **QuestionPreviewWidget 重构**：优化题目预览布局，答案显示区域移至底部，提升阅读体验；修复 Markdown/LaTeX 渲染适配问题。
    - **全局视觉优化**：引入现代化 QSS 样式，统一按钮、列表、输入框风格；优化 Splitter 默认比例与窗口初始大小。
    - **布局精简**：移除辅助答题界面冗余的预览组件，最大化利用屏幕空间展示题目列表与搜索结果。

  - **配置与管理体验优化**：
    - **题库启用管理重构**：左侧题库列表为每个题库项增加勾选框用于启用/禁用，去除右侧“题库详情”中的启用勾选框，交互更直观。
    - **抽取数量交互升级**：题库详情的“抽取数量”支持“滑动条 + 数字输入框”双方式控制，并进行联动；布局调整为水平排列，保证输入框显示完整。
    - **乱序题目可控**：新增“乱序题目”开关，支持控制练习时是否对题目进行洗牌，并写入配置持久化（config.json 中的 ShuffleQuestions）。

## v2.0

  - **新增 PTA 智能题库获取**：
    - **内置浏览器集成**：新增“自动获取题库”窗口，内置浏览器直接登录 Pintia 平台，无需手动复制 HTML。
    - **一键解析**：支持一键解析当前页面的选择题、判断题、填空题，自动提取题干、选项与答案。
    - **智能评测状态识别**：自动识别题目在 PTA 上的评测结果（正确/错误/未评测），并在题目列表中以绿色/红色/黄色高亮显示，错题一目了然。
    - **图片自动抓取与本地化**：自动扫描题干中的图片，支持预览；保存题库时可勾选自动下载图片到本地 `asset` 目录，并自动替换为相对路径，实现题库的完全离线化。
    - **统计与提示**：实时统计解析结果，输出错题题号与未评测题目数量，辅助核对。

  - **题库编辑器 (BankEditor) 重大升级**：
    - **全新 UI 设计**：题目列表升级为卡片式设计，支持等高排列、圆角风格与动态交互，视觉体验大幅提升。
    - **功能增强**：支持“打开任意文件”与“另存为”操作，不再局限于特定目录；支持嵌入模式，方便在不同场景复用。
    - **状态联动**：与 PTA 解析功能深度集成，支持显示题目的外部评测状态。

  - **配置与管理体验优化**：
    - **创建科目**：Config 界面新增“创建科目”功能，无需手动创建文件夹，输入名称即可一键建立。
    - **创建题库**：新增“创建题库”向导，支持快速生成包含模板题目的 JSON 文件，降低新用户上手门槛。
    - **界面优化**：调整 Config 界面布局，操作逻辑更加符合直觉。

## v1.2

  - **重构图片处理逻辑**：
    - 彻底移除旧版字符串形式的 `image` 字段支持，统一使用对象格式（如 `{"img1": "path"}`）
    - 移除代码中的绝对路径回退逻辑，强制使用相对路径或 Markdown 引用
    - 优化 Markdown 图片渲染，支持通过 `![](img1)` 等键名直接引用图片
  - **优化选择题渲染**：
    - 修复选择题选项高度不自适应的问题，现在选项框高度会根据内容自动调整
    - 选择题选项全面支持 Markdown 和 LaTeX 数学公式渲染
    - 解决选项内容过长时的遮挡问题，引入最大高度限制和滚动条
    - 题库编辑器中的选项输入框升级为 `QTextEdit`，支持多行输入和富文本编辑
  - **新增辅助工具**：
    - 新增旧题库转换脚本 `convert_old_problembank.py`，用于批量将旧版 JSON 题库转换为新版格式



## V1.1

- 修复了markdown渲染问题，包括换行和代码块的渲染
- 修复了`[]`内容会被作为数学公式渲染的问题
- 修复了导入错题时会出现丢失的问题
- 修复了切换题目时，作答痕迹会消失的bug

## v1.0

  - **新增题库编辑功能**：全新的题库编辑器，支持创建、编辑和管理各种题型的题目
  - **新增题库预览功能**：实时预览题目内容和格式，确保题目显示效果
  - **支持多题型编辑**：完整支持选择题、判断题、多选题和填空题的编辑
  - **智能题库管理**：自动识别题库文件路径，支持从配置文件中读取科目路径
  - **增强用户体验**：提供直观的编辑界面和实时预览，简化题库创建流程
  - **完善错误处理**：添加详细的调试信息和用户友好的错误提示

## Beta 0.3

  - **新增Markdown渲染支持**：集成Qt WebEngine模块，支持在题目中使用Markdown格式，包括粗体、斜体、代码块、列表等格式
  - **新增LaTeX数学公式支持**：集成KaTeX引擎，支持在题目中渲染LaTeX数学公式，提升数学类题目的显示效果
  - **优化题目显示**：通过`MarkdownRenderer`类提供更好的题目内容渲染体验
  - **新增自动适配大小功能**：`MarkdownRenderer`组件现在支持根据内容长度自动调整高度，同时确保不超出主窗口范围
  - **改进用户体验**：题面和选项渲染器能够智能适配内容大小，提供更好的视觉效果
  - **修复渲染问题**：完全重构了LaTeX公式和代码块的处理逻辑，摒弃占位符机制，直接在解析过程中处理内容
  - **改进依赖管理**：添加Qt WebEngine模块依赖，确保Markdown和LaTeX功能正常运行

## Beta 0.2(2025/05/31)

  - 修复了练习模块 (`practicewidget.cpp`) 和错题复习模块 (`reviewwidget.cpp`) 中，当题目文本（如代码片段）包含特殊HTML字符（例如 `<`, `>`）时，可能导致的题目显示不完整或渲染异常的问题。通过在 `updateQuestionDisplay` 和 `displayWrongAnswerDetails` 方法中对这些特殊字符进行转义，确保了题目内容的正确渲染。
